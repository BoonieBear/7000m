#include "StdAfx.h"
#include "TurboCode.h"
#include <math.h>

int d1[LLL],d2[LLL],dd1[LLL],dd2[LLL];
int D1[LLL/2],D2[LLL/2];
int B[LLL]={
	269,1718,1207,680,1110,5,1532,865,1349,1219,1471,458,33,1545,1805,1869,524,626,1738,291,1502,406,257,1016,509,1019,1722,951,1188,66,242,1424,1619,
	4,1307,961,740,812,862,1898,1030,1167,1487,609,792,1894,176,977,852,25,498,1203,491,1796,1507,1215,1161,1153,1388,549,131,106,1176,42,816,1516,724,
	1884,914,1265,37,968,468,1569,676,767,803,755,1450,874,1310,382,1041,975,1757,983,1091,1109,228,75,1281,1589,394,629,871,27,1274,1285,1191,1875,1558,
	1649,1929,945,1526,855,357,598,101,776,672,1098,571,1896,195,1083,347,136,379,69,1256,1543,1263,1631,1624,1772,1742,581,891,689,155,733,245,1743,695,
	307,1418,57,697,1170,729,1063,1763,1637,402,728,1070,637,1472,856,727,91,12,320,899,1362,160,239,700,548,300,1452,432,171,3,219,408,1673,1922,1080,
	1051,880,1689,297,1085,1204,494,940,459,1425,1356,321,81,1089,1414,1221,1174,1328,215,1250,785,1370,1151,1537,1667,1759,174,71,791,1556,999,754,710,
	540,1052,1152,1365,1210,892,439,1476,586,342,1712,515,1906,488,1625,455,713,1531,707,516,1229,530,1540,834,378,771,9,1622,1623,615,1550,633,230,249,
	702,1508,1500,1390,1643,1461,1335,1860,1873,93,1352,1630,1699,1090,547,1211,699,1524,1587,1501,386,225,717,441,363,1357,1821,1470,1674,1874,392,924,
	120,163,1047,89,913,1899,235,745,224,658,845,770,1657,411,607,837,796,1350,198,477,1474,1200,919,805,905,1755,1244,49,513,1329,694,500,1038,305,303,
	715,1146,650,557,188,1017,1559,295,430,493,389,1205,799,344,1081,1787,824,1268,1178,1510,584,1789,1087,712,930,266,1137,335,1530,100,296,503,1421,938,
	1015,110,87,74,842,434,1823,1771,1811,1723,299,1850,108,456,1828,851,741,1847,1608,832,667,447,1035,1923,284,1368,92,1547,68,505,236,823,186,365,359,
	885,62,561,424,1891,1094,1776,554,1684,1061,280,1788,1247,250,1125,525,1446,1000,800,1849,1391,1911,1586,573,85,1,229,696,326,605,1567,1546,588,742,
	1440,825,153,794,979,645,686,1606,313,801,113,1578,44,1013,884,1131,1078,1443,1868,1409,151,778,1818,204,1065,782,154,1548,1154,261,840,1853,627,669,
	692,1401,1555,569,1302,1447,1494,1904,814,388,1815,766,1184,952,1843,950,205,640,1103,743,1427,942,1055,954,578,673,1799,1216,157,338,337,304,1129,
	495,1233,1193,1480,623,904,1504,490,1671,1878,907,1603,1395,1113,773,666,324,6,992,1071,1212,80,436,59,758,1239,594,1032,649,298,140,1521,1710,1895,
	1666,1931,1406,725,181,82,1025,184,811,551,1780,1295,593,289,917,1260,256,1222,178,1803,467,511,1926,177,706,703,777,487,471,839,1453,1297,314,611,
	30,400,928,1266,1380,65,1734,1351,1808,1199,1598,1720,333,898,1798,1491,1527,253,1735,1066,1118,1454,428,688,277,1104,1646,200,815,841,191,910,1520,
	1138,1483,967,655,398,939,1553,539,1585,121,1829,243,1040,293,1754,1317,1002,886,964,1679,1467,779,1262,419,1313,532,247,452,504,1574,583,1668,1292,
	869,543,278,1641,1697,36,255,1782,592,1044,470,1430,1102,632,203,1202,1439,606,1132,133,1495,15,1651,835,1321,1008,1323,58,568,170,764,1645,563,1383,
	1489,956,597,1056,190,861,1116,668,327,1854,1217,197,1375,41,721,130,1007,1886,1413,1130,7,331,1580,1361,1695,482,1326,512,1773,396,836,1492,1347,
	1737,362,38,1741,463,1740,981,272,635,416,749,929,1597,881,111,602,1573,72,114,1797,1503,1423,1579,1437,1826,1912,182,1561,497,1634,1099,1511,972,
	1807,1817,1062,414,1245,385,653,1376,1348,576,1930,1457,1451,522,1419,312,528,1549,730,1614,1903,1517,642,1392,936,1420,684,1280,356,993,1304,1331,
	1275,1422,353,1344,214,1686,129,781,150,1905,1133,45,953,254,541,1214,1034,1525,1004,1827,687,1617,1396,453,990,1703,1068,1845,518,84,876,1756,1234,
	820,1839,1908,282,1620,1458,774,287,1232,1163,1928,1834,538,716,221,1910,213,109,701,127,1074,429,1840,768,965,180,612,1296,704,682,986,750,96,1284,
	415,187,1114,1364,735,1764,125,1186,55,1748,405,798,374,218,565,21,1286,1115,348,737,1196,1889,1432,1369,1373,322,260,1628,1529,1675,989,1838,1198,
	1729,1012,1702,572,948,1255,271,95,570,137,138,1554,128,472,908,1048,1497,14,582,124,1932,708,660,334,1140,1228,897,1615,0,1505,932,1618,381,425,664,
	693,654,1672,336,77,850,641,1426,959,1122,156,105,1308,372,1612,736,1670,1844,1001,1590,1398,226,941,391,506,1862,1907,1498,1658,648,51,564,827,795,
	1541,489,1515,1282,380,1885,1046,1901,1213,1749,1303,603,1355,1871,1183,384,1576,793,761,946,1478,460,545,982,895,575,652,531,1246,1314,617,1694,1166,
	1053,358,1676,1479,1693,17,208,11,1682,483,643,631,1155,1249,1486,1462,1705,1677,1327,1692,126,1028,1003,1660,1562,542,201,1581,1111,1713,601,1319,
	610,1135,1888,784,1036,1121,1760,1661,1466,783,1092,183,1082,555,875,1411,189,507,264,1750,1059,1253,1709,1259,580,1644,292,864,23,916,1918,1434,1900,
	1877,618,349,168,949,619,786,1160,1011,1791,440,519,1629,1867,1248,319,1100,1402,1565,240,818,1460,393,1325,1490,1181,1859,1663,144,1688,1724,1387,
	1394,135,963,705,220,427,1790,454,1359,621,1592,1042,1258,752,1106,926,1417,1009,145,1852,813,889,912,1291,726,1251,559,762,1298,1377,478,624,462,
	675,1033,1336,361,1123,185,685,1924,765,1570,1687,1633,853,437,1700,1142,1126,1031,984,883,1079,1824,879,987,143,1882,521,390,789,1538,251,510,1770,
	1777,267,608,604,340,1029,821,399,1381,1469,1067,417,1057,10,909,422,1225,634,332,122,1384,1825,1173,1768,194,90,731,988,366,1812,1237,763,1049,1027,
	1711,1162,866,1185,577,196,102,1801,164,1866,152,1287,464,1279,435,1639,867,918,373,1482,534,1037,1704,978,1026,1410,817,1022,1523,1157,1864,1399,790,
	1519,123,574,923,426,1097,158,1108,371,469,723,1289,1664,1332,149,1551,1346,354,976,343,376,804,263,1830,1252,1683,1822,1315,720,757,1290,1006,1512,
	375,591,1143,1316,29,63,258,1294,1753,636,970,35,1312,753,1208,450,64,351,1227,1405,134,265,1714,1706,1626,896,1235,1134,567,1223,1190,1064,873,165,
	888,872,1539,760,206,1721,473,46,780,1468,232,1856,1604,759,118,1566,404,1835,1224,223,222,1655,139,1147,1021,859,1887,1601,259,1045,107,980,1277,345,
	1293,1514,212,19,1652,211,1813,1717,1733,1238,552,1636,751,116,231,931,670,1635,451,1786,962,1588,1775,132,674,1231,831,1528,1139,79,854,1243,421,1168,
	1739,1715,1533,546,162,1927,1119,868,1429,870,671,1358,1024,903,558,159,974,663,148,775,22,1436,1499,819,656,1379,843,828,1058,769,1330,207,420,31,387,
	1769,1881,1846,1681,443,1374,1599,32,241,1261,1725,1159,901,1568,1744,1831,1272,1560,1445,1382,501,595,644,587,1542,1333,579,1338,1621,1594,944,995,
	1613,83,246,1656,1897,274,1175,290,147,1438,1708,1544,1306,1412,1602,1197,1343,1124,1086,1455,1095,316,318,590,527,276,73,346,216,1726,1535,238,1264,
	739,600,395,1088,1240,625,1201,1680,971,566,1917,1179,991,76,1010,1596,60,1536,1761,788,364,1802,1144,1018,217,1506,94,1841,1851,169,1865,1832,1707,
	553,1552,1464,1128,339,1863,508,1793,461,1276,1337,423,1107,1299,1814,1077,418,1751,273,485,1481,894,1858,1914,484,1318,1513,550,833,1795,86,1572,848,
	1902,882,523,638,1747,1378,520,1127,797,317,1640,1339,1836,1921,1218,377,1320,529,683,24,1189,465,1428,1194,1117,1584,1933,499,661,1736,1340,48,88,
	1230,1241,502,209,1575,849,906,1678,1564,1465,315,935,614,802,829,286,1300,1833,67,1463,1857,893,1145,476,787,1442,646,28,1484,1283,1653,1257,1120,
	922,1407,997,722,309,1731,1043,1273,1164,1050,369,1669,52,585,1475,1278,330,433,360,1698,301,994,1935,1220,1496,202,596,103,1149,1072,199,748,457,
	1762,1301,308,98,1156,1794,1236,756,960,1607,738,1765,657,329,99,934,677,915,1784,562,370,431,1752,39,1158,1577,1919,97,651,1872,933,1345,1039,1861,
	1647,268,1023,679,1654,448,1915,1855,302,1913,341,957,1342,1353,1165,1518,1893,1534,413,210,1180,744,806,50,1014,900,838,383,1627,1758,1054,368,810,
	1638,1270,1187,1075,925,1870,397,227,1785,890,119,628,1182,244,1341,288,1732,367,1800,54,714,1809,412,927,662,589,1648,486,1403,878,466,747,1779,678,
	958,1730,1746,481,998,1609,1322,1820,1883,1485,1591,613,1767,1385,53,34,70,1557,1792,1324,1360,955,1909,1925,1366,1842,1848,1611,599,279,1400,1389,
	1267,1659,1148,193,844,1593,921,1691,1719,16,517,911,1727,1209,1020,1354,355,1112,1415,1690,691,681,56,492,1386,920,350,533,248,233,1616,1493,325,281,
	1192,966,1309,1605,902,283,262,1435,1169,1571,1367,1774,1288,8,1242,526,973,172,179,474,630,61,306,43,1084,234,1404,943,294,616,1766,175,1363,1136,
	444,535,985,1371,237,1781,1269,1600,937,1101,1783,1804,1473,1226,1488,275,1595,13,860,1271,1892,141,1206,1563,659,1093,1171,887,808,446,718,809,142,
	1069,323,192,1393,665,115,352,1728,556,146,807,1890,560,409,479,1662,252,1696,1431,719,1449,1060,1934,112,1305,1005,1837,1685,1096,1509,78,20,1372,
	1416,1610,18,1632,270,772,1880,1150,639,1441,1448,1642,1819,537,1876,858,947,698,285,1459,709,40,877,438,2,1311,1254,310,475,647,544,1879,1522,161,
	328,1177,620,47,1650,830,1334,1444,1477,1076,1433,746,1745,822,732,1583,173,847,166,401,846,1408,104,1778,1582,996,442,1806,711,403,117,26,445,407,
	1073,480,826,536,863,969,1716,1141,1397,690,167,311,496,1810,514,1701,734,1920,622,1195,1665,449,410,1916,1456,1105,1816,857,1172};

int B0[LLL/2]={
	725,656,806,239,824,727,770,888,940, 23,251,219, 91,533,154,632,525,688,795,932,712,436,408,500,123, 30,732,
    161,679,162,504,890,  7, 41,916,621,590,592,152,900,359,898,875,627,158,566,207,823,151,479,450,241,304,471,
    192,119,664,842,329,882,165, 20,299,117,345,927,488, 98,717,485,850,624,532,385,323,469,540,531,887,193,462,
    567,684,313,170,943,428,346,363,157,915,499,817,484,660,763,724,903,587,815,405,552,335,290,623,475,782,206,
    180,473,556,931,851,708,761,498,456,849,905,144,620,907,910,606,854, 90,220,598, 24,293,764,830,371,605,666,
     54,645,174,228,895,555,937,661,637,917,212,355,874,869,896,838,227,852,366,421,669,783,676,519,198,760,447,
     84,197,388,655, 14,626,580,886,517,284,929,920,380, 49,163,195,229,647,586,594,792,686,541, 50,260,729,949,
    871, 26,247, 29,800, 93,470,341, 38,746, 25,145,110,460,839,491,141,565,659,130,513,885,840,762,857,440,908,
    768,105,534,445,879,572,843,617,  1,775,190,788,187,939,486,264,948,214,191,911,614,508,390,378,596,454,829,
     87,317,635,709,185,822,302,412,622,928,510,950,489,211,137,836,856,347, 86,563, 28,342,184,630,543,784,767,
    411,716, 96,611,400,453,926,501,876,482, 67,493,816,325,240, 94,777,813,431, 52, 48,121,404,964,846,528,398,
    689, 71,835,906,526,845,668,153,897,774,545,202,386,938,706,465,132,671,352,861,639,738,692,819,103,602,267,
    327,201,569, 68,396, 66,780,803,226,892,379, 21,173,449,330,899,966,610,300,203,292,430,166,257,631,933, 74,
    148,276,468,578,466,477,365,250, 56, 43,542,867,651,111,737,155,667,913,269,884,204,422,401,909,941,272,818,
    609,674,246,397, 15,662,663,348,382, 18,673,399,135,237,273,120,776, 35,564,252,582,321,230,101,364,277, 47,
    222,310,104,332,603,128,810,200,138,652,172,406,429,374,  9, 77, 32,427,687,758,446,236,181,418,728,150,369,
    171,714,461,  6,765,235,536,208,234,426,114,683,383,393, 34,570,407, 97,745,604,416,349,718,353,178,789,924,
    694,653,743,289,786,  3,961,576,283,232,381,925, 60,331,129,492,581, 45,548,402,755,739,675,392,539,700,914,
    281,319,658,702,102,535,593,423,599,442,474, 82,759,677, 37,790,108,579,607, 69,837,629,344,520,394, 53,726,
    772,954, 76,301,265,859,245,324,179,785,435,507,695,721,713,464,333,781,740,588,279,472,294,642,115, 73,425,
    262,636,305,825,149,747,106,864,538,100,164,391,707,771,205, 59,936,638,804,278,358,437,351,354,303,480,883,
    316,514,118, 27,515,703,  2,146,654,387,160,812,361,384,159,873, 10,805,696,334,698,855,731,375,258,389,506,
     79,904,521,248,343,613,270,143,756,147,167,263,311,518,953,828,546,648,377,616,109,194,678,963,131, 63,215,
    942,243,831,559,841,722,773,274,268,574,640,516,512, 65,583,965, 95,697,561,409,291,217,619,497,748,844,711,
    957,649,340,958, 39,778,494,584,296,801,175,749,523,530,881,328,113, 42,618, 51,156,140,699,522,225,169,809,
    242, 78,682, 55,934,271,176,285,306,811,362,458, 75,537,288,441,862,413, 46,922,858,444,951,701,946,595,182,
    280,168,424,847,558,403,893,410,868,608,134, 70,177,259,320,249,628,672,224, 89,752, 13,309,826,136, 31,866,
    308,511,253,560,337,451,736,433,107,734,  5,557,496,741,796,124,944,373,476,751,544,650,723,872,282,527,742,
    947,112,414,730,766,889,127,657,338,644, 11,757,791,901,254,116, 80,956,744,312,710,681,419,188,287,827,360,
    553, 22,798,339,833,233,438,502,962, 64,221,505,959,685,  8, 62,509,705,295,478,550,420,356, 44,646,367,691,
    680,275, 40, 72,821,368,142,196,918,256, 36,459,955,568,463,432,625, 58,231,814,326, 57,573,641,186,634,753,
    467,612,209,372,591,218,923,213,318,122,690, 88,524,891,919, 83,865,693,562,483,633,935,223,733,575,  4,183,
     19, 92,452,600,670,336,808, 61,238,417,261,715,735,554,189,769,350,793,853,571,315, 17,930,551,255, 12,794,
    720,799,529,802,912,834,266, 33,455,443,487,139,597,210, 16,967,779,457,860,665,395,601,750,863,820,314,832,
    797,549,481,434,  0,878,376,787,848,357,870,370, 81,585,495,880,133,322,298,307,704,216,894,448,589,945,960,
    125,877,439,952,615, 85,643,807,286,244,719,503,415,547, 99,126,754,921,577,199,902,297,490};
int B1[LLL/2]={
    113,363,798,609,882,415,734,333,116,513,165,203,379,431,592,463,603,650,483,191,600,733,176, 82,944,702,411,
     74,903,413,871,  8,764,800,184,833,655,677,280,488, 18,801,502,175,872, 79,528,611,887, 36,894,319,335,794,
    930,521,551,928,269,540,558,665, 21,244,251, 83,206,328,313,529,407,389,918,658,178,958,292,465,485,814,210,
    957,318,356,667,876,330,735,823,361,264,533,464,448, 38, 86,519,731,623,638,878,691,454,354,230,891,218,851,
    522,500,685,101,181,678,595,295,296,929,562,197,908,403,615, 80,662,449,852,631, 99,725,866, 96,673,219,307,
    556,960,945,187,374,388,368,745,557,285,524,563,256,146,525,584,653,517,810,701,900,222,772,547,137,271,491,
    620,372,315,505,676,487,906,104,711,258,154,841,847,493,599, 89,179,200,951,621,348,189,765, 12,873,627,962,
    120, 93,910,583,905,964, 45,213,284,805, 58,467,569,209,450,376,586,963,135,961, 88,259,651,824, 46,590,938,
    223,763,747,549,332,414,626,164,593,360,843,149,696,766,755,380,868,695,856,482, 49,163, 64,384,797,757,434,
    541,681,305,857,370,830, 23,955,736,443,692,132, 98,666,398,719, 62, 35,714,904,561,921,808,162,320,273,275,
    492,819, 95,174,539,504,811,130,352,632,771,608,331,641,818,183,507,853, 13, 51,712,966,148,515, 17, 24,888,
    786,143, 47, 69,277,231,646,150,700,171,774,933,246,686,947,570,890,760,393,885,110,205,479,612,494,338,748,
    334, 33,106,383,480, 53,654,169,854,236,472,935,346,750,406,614,527,107,136,544, 65,396,575,355,161,836,850,
    659,131,642,420,227,591,566, 52,470,359,  9,663, 85,248,173,412,789,790, 67,509,193,791,911,300,732,308,208,
    613,545, 30,785,779,133,152,893,198,652,697,439,400,881,924,943,139,838,816,254,144, 26,129,194,172,553,832,
    323,796,215,837, 44,942,108,799,704,511,737,828,571,115,349, 11,927,738,762,744,155,604,792,433,916,322,578,
    468,537, 40,317,622,  5,530,649,325,752,180,680,157,192,394,241,660,249,715,795,842,112,294,392,643,901,829,
    391, 43,741, 72,776,395,572,445,633,768,168, 63,948,576, 75,728,123,839,399,503,628,787,462,312,267, 78,170,
    327,923,490,716,247, 87,409,717, 84,579,826,884,726,481,362,634,382,304,914,520,  7,217,949,390,516, 25,255,
    128, 16,739,674, 66,925,559,754,954,636,784,240,761,848,959,343,402,274,780,727, 14, 90,476,345,827,897,687,
    499,364,459,430,416,552,834,371,279,138,121,103,723,664,580, 42,548,730,289,879,863, 29, 32,340,770, 28,158,
    952,907,675, 92,825,607,401,670,773,324,310,229,373,749,263,358, 34,601,486,  3,281,290,404,630,769,489,618,
    125,457,220,311,936,397, 55,425,299,105,417,926,538,860,581,822,922, 22,753,812,915,956,718,424,722,253,422,
    506,141,375,694,186,427,855,341, 71,639,242,378,288,568,350,419,471,939,937,228,410,475, 70,283,536,477,909,
    118,234,706,302,474,821,297,156,418,272,151,699,950,820,291,321,693,239,286,802,429,870,326,898,892,145,484,
    813,746,807, 31,339,679,775,777,225,452,523,518, 54,  1,758,698,387,953,720,122,668,365,815, 19,440, 73,742,
    344,597,862,835, 39,124,682,896,902,684,114,596,278,840,268,617,301,931,473,202,428,543,207,266,438,683,232,
    883,495,512,864, 56,531,598,880,861,235,369,514, 20,260,276,298,605,689,781,147,877,767,817,226,237,446,542,
    437,705,466,196,426,497,405,109,250,967,214,337,316,211, 57,386,166,889,385,913,574,532,709,546,661,565,573,
    759,314,182,587,199,456,555,293, 68,865,381,458,845,886,303,441,756,  6, 37,204,859,  4,585,912,594,160,221,
    367,423,238,941,306,619,469,644,567,188,656,550,100,287,224,501,782,793,690,496,965, 48,606,635,252,216,624,
    648,560,455,917,858, 94,111,920,564,342,783,831,946,610,803,134,447,629, 27, 59,282,261,119,713, 10,159, 60,
    127,688,442,671,899,453,195,357, 15, 91,849,508,461,708,846,201,451,309,554,233,804,377,498,577,669,809,366,
    421,724,102,582,640,934,243,778,588, 81,478,743,190,353, 61,875,270,867,940,707,589,167,703,435,534,  0,806,
    710,185,  2,751,844,645,351,153,444,535,526,117,245,510,874, 50,142,919, 97,788, 77,140,432,657,265,177,126,
    625, 76,740,721,460,336,869,408,672,602,932,329,436,637,347,257,647,212,262, 41,616,729,895};

void Rand_Deinterl(int *y)
{//该函数用于解交织。
     int k;
    for(k=0;k<LLL;k++)//把偶数位和奇数位分开.
    {
       if((k%2)==0)
       {
       	   d1[k]  =*(y+2*k);
           d1[k+1]=*(y+2*k+1);
       }
       else
       {
       	   d2[k-1]=*(y+2*k);
       	   d2[k]  =*(y+2*k+1);
       }
    }
    for(k=0;k<LLL/2;k++)  
    {                         
       dd1[2*B0[k]]  =d1[2*k];    //把原序列的奇数位次序还原后还放到奇数位。
       dd1[2*B0[k]+1]=d1[2*k+1];
       dd2[2*B1[k]]  =d2[2*k];    //把原序列的偶数位次序还原后还放到偶数位。
       dd2[2*B1[k]+1]=d2[2*k+1];
    }
    for(k=0;k<LLL;k++)//把o1和o2合并为一个数组//
    {
    	if((k%2)==0)
    	{
    		*(y+2*k)  =dd1[k];
            *(y+2*k+1)=dd1[k+1];	
    	}
    	else
    	{
    		*(y+2*k)  =dd2[k-1];
            *(y+2*k+1)=dd2[k];
    	}
    }
}
void OUT_interleave(int *y)
{//该函数用于外部交织。
	register int i;
	int ss[2*LLL];
	for(i=0;i<LLL;i++)
	{
		ss[2*i]  =*(y+2*B[i]);
		ss[2*i+1]=*(y+2*B[i]+1);
	}
	for(i=0;i<2*LLL;i++)
	{
		*(y+i)=ss[i];
	}
}

void convenc(int *a,int *b)
{//按生成多项式[23，35]进行卷积编码。
	register int i;
	int D[5]={0,0,0,0,0};
	for(i=0;i<LLL;i++)
	{
		D[4]=D[3]^*(b+i);
		D[3]=D[2]^D[4];
		D[2]=D[1]^*(b+i);
		D[1]=D[0]^*(b+i);
		D[0]=D[4]^*(b+i);
		*(a+i*2)   = *(b+i);
		*(a+i*2+1) = D[4];
	}
}
void Rand_Interl(int *d)
{//该函数用于对bit流交织。
    register int i,j;
    for(i=0;i<LLL;i++)//把偶数位和奇数位分开。
    {
    	j=i>>1;
    	D1[j]=*(d+i);
    	i++;
    	D2[j]=*(d+i);
    }
    for(i=0;i<LLL;i++)//把D1和D2合并为一个数组。
    {
    	j=i>>1;
    	*(d+i)=D1[B0[j]];
    	i++;
    	*(d+i)=D2[B1[j]];
    }
}

void convenc8(int *a,int *b)
{
	int i,j,k;
	int D[5]={0,0,0,0,0};//代表移位寄存器。
	for(i=0;i<LLL;i++)
	{//根据生成多项式得到。
		j=2*i;
		k=j+1;
		D[4]=D[3]^(*(b+j)^*(b+k));
		D[3]=D[2]^(*(b+k)^D[4]);
		D[2]=D[1]^*(b+j);
		D[1]=D[0]^(*(b+j)^*(b+k));
		D[0]=D[4]^(*(b+j)^*(b+k));
		*(a+3*i)  = *(b+j);
		*(a+3*i+1)= *(b+k);
		*(a+3*i+2)= D[4];
	}
}

void OUT_interleave8(int *g)
{
	register int i,j,k;
	int d[3*LLL];
	for(i=0;i<LLL;i++)
	{
		j=3*i;
		k=3*B[i];
		d[j]  =g[k];
		d[j+1]=g[k+1];
		d[j+2]=g[k+2];
	}
	for(i=0;i<3*LLL;i++)
	{
		g[i]=d[i];
	}
}

void Rand_Deinterl8(int *y)
{//该函数用于解交织。
    int k,y0,y1,y2;
    int d1[3*LLL/2],d2[3*LLL/2],dd1[3*LLL/2],dd2[3*LLL/2];
    for(k=0;k<LLL;k++)//把偶数位和奇数位分开，并按照伪随机顺序分别排序。
    {
    	y2=3*k;
        if(k%2==0)
        {
        	y0=3*k/2;
        	d1[y0]  = y[y2];
        	d1[y0+1]= y[y2+1];
        	d1[y0+2]= y[y2+2];
        }
        else
        {
        	y1=3*(k-1)/2;
        	d2[y1]  = y[y2];
        	d2[y1+1]= y[y2+1];
        	d2[y1+2]= y[y2+2];
        }
    }
    for(k=0;k<LLL/2;k++)//把o1和o2合并为一个数组
    {
    	y0=3*B0[k];
    	y1=3*B1[k];
    	y2=3*k;
        dd1[y0]  =d1[y2];
        dd1[y0+1]=d1[y2+1];
        dd1[y0+2]=d1[y2+2];
        dd2[y1]  =d2[y2];
        dd2[y1+1]=d2[y2+1];
        dd2[y1+2]=d2[y2+2];
    }
    for(k=0;k<LLL;k++)
    {
    	y2=3*k;
    	if(k%2==0)
    	{
    		y0=3*k/2;
    		y[y2]  =dd1[y0];
    		y[y2+1]=dd1[y0+1];
    		y[y2+2]=dd1[y0+2];
    	}
    	else
    	{
    		y1=3*(k-1)/2;
    		y[y2]  =dd2[y1];
    		y[y2+1]=dd2[y1+1];
    		y[y2+2]=dd2[y1+2];
    	}
    }
}

void Rand_Interl8(int *d)
{//该函数用于对bit流交织。
	int D1[LLL/2],D2[LLL/2],DD1[LLL],DD2[LLL];
    int i,j;
    for(i=0;i<2*LLL;i++)//把偶数位和奇数位分开//
    {
    	j=i>>1;//j=0,1,2,3,4...
    	DD1[j]=*(d+i);//i=0,2,4,6...
    	i++;
    	DD2[j]=*(d+i);//i=1,3,5,7...
    }
    for(i=0;i<LLL;i++)//把偶数位和奇数位分开//
    {
    	j=i>>1;
    	D1[j]=DD1[i];
    	i++;
    	D2[j]=DD1[i];
    }
    for(i=0;i<LLL;i++)//把D1和D2合并为一个数组//
    {
    	j=i>>1;
    	DD1[i]=D1[B0[j]];
    	i++;
    	DD1[i]=D2[B1[j]];
    }
    /////////////////////////////////////////////
    for(i=0;i<LLL;i++)//把偶数位和奇数位分开//
    {
    	j=i>>1;
    	D1[j]=DD2[i];
    	i++;
    	D2[j]=DD2[i];
    }
    for(i=0;i<LLL;i++)//把D1和D2合并为一个数组//
    {
    	j=i>>1;
    	DD2[i]=D1[B0[j]];
    	i++;
    	DD2[i]=D2[B1[j]];
    }
    ///////////////////////////////////////////
    for(i=0;i<2*LLL;i++)
    {
    	j=i>>1;//j=0,1,2,3,4...
    	*(d+i)=DD1[j];//i=0,2,4,6...
    	i++;
    	*(d+i)=DD2[j];//i=1,3,5,7...
    }
}